import { CardWithBadge } from 'modules/Shared/components/CardWithBadge';
import { Grid, Stack, Typography } from '@mui/material';
import {
  chartDarkBlue,
  chartRed,
  chartYellow,
  textWhite,
} from 'modules/Shared/helpers/styles/Colors';
import { LoadingHandler } from 'modules/Shared/components';
import React from 'react';
import { useVulnerabilityContext } from 'modules/Vulnerability/contexts/VulnerabilityContext';
import { SEVERITY } from 'modules/Shared/enums/Vulnerability';

interface Props {
  severitySummaryData: {
    high?: number;
    critical?: number;
    medium?: number;
    low?: number;
  };
  severitySummaryIsLoading: boolean;
}

export const SeveritySummary = ({
  severitySummaryData,
  severitySummaryIsLoading,
}: Props) => {
  const { setVulnerabilitiesFilters, vulnerabilitiesFilters } =
    useVulnerabilityContext();
  return (
    <LoadingHandler loading={severitySummaryIsLoading}>
      <CardWithBadge title="Summary">
        <Grid container justifyContent="space-evenly" direction="row">
          <Grid item xs={3}>
            <Stack alignItems="center">
              <Typography variant="subtitle2">Critical</Typography>
              <Typography
                onClick={() => {
                  setVulnerabilitiesFilters({
                    ...vulnerabilitiesFilters,
                    severity: SEVERITY.CRITICAL,
                  });
                }}
                variant="h3"
                color={chartRed}
                sx={{
                  '&:hover': {
                    cursor: 'pointer',
                    opacity: '0.8',
                  },
                }}
              >
                {severitySummaryData?.critical || 0}
              </Typography>
            </Stack>
          </Grid>
          <Grid item xs={3}>
            <Stack alignItems="center">
              <Typography variant="subtitle2">High</Typography>
              <Typography
                onClick={() => {
                  setVulnerabilitiesFilters({
                    ...vulnerabilitiesFilters,
                    severity: SEVERITY.HIGH,
                  });
                }}
                variant="h3"
                color={chartYellow}
                sx={{
                  '&:hover': {
                    cursor: 'pointer',
                    opacity: '0.8',
                  },
                }}
              >
                {severitySummaryData?.high || 0}
              </Typography>
            </Stack>
          </Grid>
          <Grid item xs={3}>
            <Stack alignItems="center">
              <Typography variant="subtitle2">Medium</Typography>
              <Typography
                onClick={() => {
                  setVulnerabilitiesFilters({
                    ...vulnerabilitiesFilters,
                    severity: SEVERITY.MEDIUM,
                  });
                }}
                variant="h3"
                color={chartDarkBlue}
                sx={{
                  '&:hover': {
                    cursor: 'pointer',
                    opacity: '0.8',
                  },
                }}
              >
                {severitySummaryData?.medium || 0}
              </Typography>
            </Stack>
          </Grid>
          <Grid item xs={3}>
            <Stack alignItems="center">
              <Typography variant="subtitle2">Low</Typography>
              <Typography
                onClick={() => {
                  setVulnerabilitiesFilters({
                    ...vulnerabilitiesFilters,
                    severity: SEVERITY.LOW,
                  });
                }}
                variant="h3"
                color={textWhite}
                sx={{
                  '&:hover': {
                    cursor: 'pointer',
                    opacity: '0.8',
                  },
                }}
              >
                {severitySummaryData?.low || 0}
              </Typography>
            </Stack>
          </Grid>
        </Grid>
      </CardWithBadge>
    </LoadingHandler>
  );
};
