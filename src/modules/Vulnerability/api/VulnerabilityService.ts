import { BaseService } from 'modules/Shared/services/BaseService';
import { IVulnerability } from 'modules/Vulnerability/interfaces';
import { ROUTES } from 'modules/Shared/constants/routes';
import AxiosClient from 'modules/Shared/services/AxiosClient';

const VulnerabilityService = () => {
  const customEndpoints = {
    getAgentVulnerabilities: async (elasticsearchId: string, filters: string) =>
      (
        await AxiosClient.get(
          `${ROUTES.BRAGI.VULNERABILITY}/agent/${elasticsearchId}${filters}`
        )
      ).data,
    getAgentSeveritySummary: async (elasticsearchId: string) =>
      (
        await AxiosClient.get(
          `${ROUTES.BRAGI.VULNERABILITY}/agent/${elasticsearchId}/severity/summary`
        )
      ).data,
  };

  return {
    ...BaseService<IVulnerability>(ROUTES.BRAGI.VULNERABILITY),
    ...customEndpoints,
  };
};

export default VulnerabilityService();
